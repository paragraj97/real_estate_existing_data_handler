b = '''23.139.76.5,
23.139.76.6,
23.139.76.7,
23.139.76.8,
23.139.76.9,
23.139.76.10,
23.139.76.11,
23.139.76.12,
23.139.76.13,
23.139.76.14,
23.139.76.15,
23.139.76.16,
23.139.76.17,
23.139.76.18,
23.139.76.19,
23.139.76.20,
23.139.76.21,
23.139.76.22,
23.139.76.23,
23.139.76.24,
23.139.76.25,
23.139.76.26,
23.139.76.27,
23.139.76.28,
23.139.76.29,
23.139.76.30,
23.139.76.31,
23.139.76.32,
23.139.76.33,
23.139.76.34,
23.139.76.35,
23.139.76.36,
23.139.76.37,
23.139.76.38,
23.139.76.39,
23.139.76.40,
23.139.76.41,
23.139.76.42,
23.139.76.43,
23.139.76.44,
23.139.76.45,
23.139.76.46,
23.139.76.47,
23.139.76.48,
23.139.76.49,
23.139.76.50,
23.139.76.51,
23.139.76.52,
23.139.76.53,
23.139.76.54,
23.139.76.55,
23.139.76.56,
23.139.76.57,
23.139.76.58,
23.139.76.59,
23.139.76.60,
23.139.76.61,
23.139.76.62,
23.139.76.63,
23.139.76.64,
23.139.76.65,
23.139.76.66,
23.139.76.67,
23.139.76.68,
23.139.76.69,
23.139.76.70,
23.139.76.71,
23.139.76.72,
23.139.76.73,
23.139.76.74,
23.139.76.75,
23.139.76.76,
23.139.76.77,
23.139.76.78,
23.139.76.79,
23.139.76.80,
23.139.76.81,
23.139.76.82,
23.139.76.83,
23.139.76.84,
23.139.76.85,
23.139.76.86,
23.139.76.87,
23.139.76.88,
23.139.76.89,
23.139.76.90,
23.139.76.91,
23.139.76.92,
23.139.76.93,
23.139.76.94,
23.139.76.95,
23.139.76.96,
23.139.76.97,
23.139.76.98,
23.139.76.99,
23.139.76.100,
23.139.76.101,
23.139.76.102,
23.139.76.103,
23.139.76.104,
23.139.76.105,
23.139.76.106,
23.139.76.107,
23.139.76.108,
23.139.76.109,
23.139.76.110,
23.139.76.111,
23.139.76.112,
23.139.76.113,
23.139.76.114,
23.139.76.115,
23.139.76.116,
23.139.76.117,
23.139.76.118,
23.139.76.119,
23.139.76.120,
23.139.76.121,
23.139.76.122,
23.139.76.123,
23.139.76.124,
23.139.76.125,
23.139.76.126,
23.139.76.127,
23.139.76.128,
23.139.76.129,
23.139.76.130,
23.139.76.131,
23.139.76.132,
23.139.76.133,
23.139.76.134,
23.139.76.135,
23.139.76.136,
23.139.76.137,
23.139.76.138,
23.139.76.139,
23.139.76.140,
23.139.76.141,
23.139.76.142,
23.139.76.143,
23.139.76.144,
23.139.76.145,
23.139.76.146,
23.139.76.147,
23.139.76.148,
23.139.76.149,
23.139.76.150,
23.139.76.151,
23.139.76.152,
23.139.76.153,
23.139.76.154,
23.139.76.155,
23.139.76.156,
23.139.76.157,
23.139.76.158,
23.139.76.159,
23.139.76.160,
23.139.76.161,
23.139.76.162,
23.139.76.163,
23.139.76.164,
23.139.76.165,
23.139.76.166,
23.139.76.167,
23.139.76.168,
23.139.76.169,
23.139.76.170,
23.139.76.171,
23.139.76.172,
23.139.76.173,
23.139.76.174,
23.139.76.175,
23.139.76.176,
23.139.76.177,
23.139.76.178,
23.139.76.179,
23.139.76.180,
23.139.76.181,
23.139.76.182,
23.139.76.183,
23.139.76.184,
23.139.76.185,
23.139.76.186,
23.139.76.187,
23.139.76.188,
23.139.76.189,
23.139.76.190,
23.139.76.191,
23.139.76.192,
23.139.76.193,
23.139.76.194,
23.139.76.195,
23.139.76.196,
23.139.76.197,
23.139.76.198,
23.139.76.199,
23.139.76.200,
23.139.76.201,
23.139.76.202,
23.139.76.203,
23.139.76.204,
23.139.76.205,
23.139.76.206,
23.139.76.207,
23.139.76.208,
23.139.76.209,
23.139.76.210,
23.139.76.211,
23.139.76.212,
23.139.76.213,
23.139.76.214,
23.139.76.215,
23.139.76.216,
23.139.76.217,
23.139.76.218,
23.139.76.219,
23.139.76.220,
23.139.76.221,
23.139.76.222,
23.139.76.223,
23.139.76.224,
23.139.76.225,
23.139.76.226,
23.139.76.227,
23.139.76.228,
23.139.76.229,
23.139.76.230,
23.139.76.231,
23.139.76.232,
23.139.76.233,
23.139.76.234,
23.139.76.235,
23.139.76.236,
23.139.76.237,
23.139.76.238,
23.139.76.239,
23.139.76.240,
23.139.76.241,
23.139.76.242,
23.139.76.243,
23.139.76.244,
23.139.76.245,
23.139.76.246,
23.139.76.247,
23.139.76.248,
23.139.76.249,
23.139.76.250,
23.139.76.251,
23.139.76.252,
23.139.76.253,
23.139.76.254,
163.223.120.5,
163.223.120.6,
163.223.120.7,
163.223.120.8,
163.223.120.9,
163.223.120.10,
163.223.120.11,
163.223.120.12,
163.223.120.13,
163.223.120.14,
163.223.120.15,
163.223.120.16,
163.223.120.17,
163.223.120.18,
163.223.120.19,
163.223.120.20,
163.223.120.21,
163.223.120.22,
163.223.120.23,
163.223.120.24,
163.223.120.25,
163.223.120.26,
163.223.120.27,
163.223.120.28,
163.223.120.29,
163.223.120.30,
163.223.120.31,
163.223.120.32,
163.223.120.33,
163.223.120.34,
163.223.120.35,
163.223.120.36,
163.223.120.37,
163.223.120.38,
163.223.120.39,
163.223.120.40,
163.223.120.41,
163.223.120.42,
163.223.120.43,
163.223.120.44,
163.223.120.45,
163.223.120.46,
163.223.120.47,
163.223.120.48,
163.223.120.49,
163.223.120.50,
163.223.120.51,
163.223.120.52,
163.223.120.53,
163.223.120.54,
163.223.120.55,
163.223.120.56,
163.223.120.57,
163.223.120.58,
163.223.120.59,
163.223.120.60,
163.223.120.61,
163.223.120.62,
163.223.120.63,
163.223.120.64,
163.223.120.65,
163.223.120.66,
163.223.120.67,
163.223.120.68,
163.223.120.69,
163.223.120.70,
163.223.120.71,
163.223.120.72,
163.223.120.73,
163.223.120.74,
163.223.120.75,
163.223.120.76,
163.223.120.77,
163.223.120.78,
163.223.120.79,
163.223.120.80,
163.223.120.81,
163.223.120.82,
163.223.120.83,
163.223.120.84,
163.223.120.85,
163.223.120.86,
163.223.120.87,
163.223.120.88,
163.223.120.89,
163.223.120.90,
163.223.120.91,
163.223.120.92,
163.223.120.93,
163.223.120.94,
163.223.120.95,
163.223.120.96,
163.223.120.97,
163.223.120.98,
163.223.120.99,
163.223.120.100,
163.223.120.101,
163.223.120.102,
163.223.120.103,
163.223.120.104,
163.223.120.105,
163.223.120.106,
163.223.120.107,
163.223.120.108,
163.223.120.109,
163.223.120.110,
163.223.120.111,
163.223.120.112,
163.223.120.113,
163.223.120.114,
163.223.120.115,
163.223.120.116,
163.223.120.117,
163.223.120.118,
163.223.120.119,
163.223.120.120,
163.223.120.121,
163.223.120.122,
163.223.120.123,
163.223.120.124,
163.223.120.125,
163.223.120.126,
163.223.120.127,
163.223.120.128,
163.223.120.129,
163.223.120.130,
163.223.120.131,
163.223.120.132,
163.223.120.133,
163.223.120.134,
163.223.120.135,
163.223.120.136,
163.223.120.137,
163.223.120.138,
163.223.120.139,
163.223.120.140,
163.223.120.141,
163.223.120.142,
163.223.120.143,
163.223.120.144,
163.223.120.145,
163.223.120.146,
163.223.120.147,
163.223.120.148,
163.223.120.149,
163.223.120.150,
163.223.120.151,
163.223.120.152,
163.223.120.153,
163.223.120.154,
163.223.120.155,
163.223.120.156,
163.223.120.157,
163.223.120.158,
163.223.120.159,
163.223.120.160,
163.223.120.161,
163.223.120.162,
163.223.120.163,
163.223.120.164,
163.223.120.165,
163.223.120.166,
163.223.120.167,
163.223.120.168,
163.223.120.169,
163.223.120.170,
163.223.120.171,
163.223.120.172,
163.223.120.173,
163.223.120.174,
163.223.120.175,
163.223.120.176,
163.223.120.177,
163.223.120.178,
163.223.120.179,
163.223.120.180,
163.223.120.181,
163.223.120.182,
163.223.120.183,
163.223.120.184,
163.223.120.185,
163.223.120.186,
163.223.120.187,
163.223.120.188,
163.223.120.189,
163.223.120.190,
163.223.120.191,
163.223.120.192,
163.223.120.193,
163.223.120.194,
163.223.120.195,
163.223.120.196,
163.223.120.197,
163.223.120.198,
163.223.120.199,
163.223.120.200,
163.223.120.201,
163.223.120.202,
163.223.120.203,
163.223.120.204,
163.223.120.205,
163.223.120.206,
163.223.120.207,
163.223.120.208,
163.223.120.209,
163.223.120.210,
163.223.120.211,
163.223.120.212,
163.223.120.213,
163.223.120.214,
163.223.120.215,
163.223.120.216,
163.223.120.217,
163.223.120.218,
163.223.120.219,
163.223.120.220,
163.223.120.221,
163.223.120.222,
163.223.120.223,
163.223.120.224,
163.223.120.225,
163.223.120.226,
163.223.120.227,
163.223.120.228,
163.223.120.229,
163.223.120.230,
163.223.120.231,
163.223.120.232,
163.223.120.233,
163.223.120.234,
163.223.120.235,
163.223.120.236,
163.223.120.237,
163.223.120.238,
163.223.120.239,
163.223.120.240,
163.223.120.241,
163.223.120.242,
163.223.120.243,
163.223.120.244,
163.223.120.245,
163.223.120.246,
163.223.120.247,
163.223.120.248,
163.223.120.249,
163.223.120.250,
163.223.120.251,
163.223.120.252,
163.223.120.253,
163.223.120.254'''


# python
import asyncio
from typing import List, Optional
import aiohttp
from aiohttp import ClientTimeout

MAX_CONCURRENCY = 2
REQUEST_TIMEOUT_SEC = 30
OUTPUT_FILE = "successful_ips.txt"
UNSUCCESSFUL_OUTPUT_FILE = "unsuccessful_ips.txt"
PORT = 6096
ENDPOINT = "/"


def parse_ips(raw: str) -> List[str]:
    return [ip.strip() for ip in raw.split(",") if ip.strip()]


async def check_ip(session: aiohttp.ClientSession, ip: str, sem: asyncio.Semaphore) -> Optional[str]:
    url = f"http://{ip}:{PORT}{ENDPOINT}"
    async with sem:
        try:
            timeout = ClientTimeout(total=REQUEST_TIMEOUT_SEC)
            async with session.get(url, timeout=timeout) as resp:
                status = resp.status
                # try to read the response body (may fail for binary or large bodies)
                try:
                    body = await resp.text()
                except Exception as e:
                    body = f"<error reading body: {e}>"
                snippet = (body.replace('\n', ' ')[:500]) if body else ''
                print(f"[{ip}] {status} - {snippet}")
                if status == 200:
                    return ip
        except Exception:
            # print the exception for debugging
            import traceback
            err = traceback.format_exc()
            print(f"[{ip}] EXCEPTION:\n{err}")
            return None
    return None


async def main():
    ips = parse_ips(b)
    sem = asyncio.Semaphore(MAX_CONCURRENCY)
    connector = aiohttp.TCPConnector(limit=MAX_CONCURRENCY, ssl=False)
    async with aiohttp.ClientSession(connector=connector) as session:
        tasks = [asyncio.create_task(check_ip(session, ip, sem)) for ip in ips]
        results = await asyncio.gather(*tasks)
    success = [ip for ip in results if ip]
    # build unsuccessful list in the same order as input
    unsuccessful = [ip for ip, res in zip(ips, results) if not res]
    with open(OUTPUT_FILE, "w") as f:
        f.write(",".join(success))
    # write unsuccessful IPs one per line (no comma separation required)
    with open(UNSUCCESSFUL_OUTPUT_FILE, "w") as f:
        for ip in unsuccessful:
            f.write(f"{ip}\n")
    print(f"Wrote {len(success)} successful IPs to `{OUTPUT_FILE}`")
    print(f"Wrote {len(unsuccessful)} unsuccessful IPs to `{UNSUCCESSFUL_OUTPUT_FILE}`")


if __name__ == "__main__":
    asyncio.run(main())
